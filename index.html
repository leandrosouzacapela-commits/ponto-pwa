<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controle de Ponto</title>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(180deg, #0b1220, #0f172a);
  color: #ffffff;
  text-align: center;
}

.container {
  max-width: 900px;
  margin: 0 auto;
  padding: 40px 20px;
}

h1 { font-size: 36px; margin-bottom: 20px; }

.info { margin: 6px 0; font-size: 18px; }

button {
  width: 100%;
  padding: 22px;
  margin: 14px 0;
  font-size: 22px;
  border-radius: 12px;
  border: none;
  color: #fff;
  cursor: pointer;
}

.btn-entrar { background: #22c55e; }
.btn-sair   { background: #ef4444; }
.btn-rel    { background: #2563eb; }

.hidden { display: none; }

/* ===== RELATÓRIO ===== */
#relatorio {
  display: none;
  background: #ffffff;
  color: #000;
  padding: 25px;
  margin-top: 20px;
  text-align: left;
}

#relatorio * { color: #000; }

.resumo {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin: 15px 0 20px 0;
}

.caixa {
  border: 2px solid #2563eb;
  border-radius: 10px;
  padding: 10px;
  text-align: center;
  font-weight: bold;
}

.caixa span {
  display: block;
  margin-top: 6px;
  font-size: 16px;
}

/* ===== PRINT ===== */
@media print {
  body { background: #fff; color: #000; }
  .container > *:not(#relatorio) { display: none; }
  #relatorio { display: block; }
}
</style>
</head>

<body>

<div class="container">

  <h1>Controle de Ponto</h1>

  <div class="info"><strong>Funcionário:</strong></div>
  <div class="info">
    <input id="nomeFuncionario"
      value="EDENILSON DE SOUZA PEREIRA"
      onblur="localStorage.setItem('nomeFuncionario',this.value)"
      style="background:transparent;border:none;color:#fff;font-size:18px;font-weight:bold;text-align:center;width:100%;outline:none;">
  </div>

  <div class="info" id="dataHora"></div>

  <button class="btn-entrar" onclick="registrar('ENTRADA')">ENTRAR</button>
  <button class="btn-sair" onclick="registrar('SAIDA')">SAIR</button>

  <button class="btn-rel" onclick="abrirRelatorio()">RELATÓRIO / PDF</button>

  <div id="relatorio">
    <h2 style="text-align:center">RELATÓRIO DE PONTO</h2>
    <h3 id="tituloNome" style="text-align:center"></h3>
    <div id="periodoRelatorio" style="text-align:center;font-weight:bold"></div>

    <div class="resumo">
      <div class="caixa">DIA<span id="rDia">00h:00min</span></div>
      <div class="caixa">SEMANA<span id="rSemana">00h:00min</span></div>
      <div class="caixa">MÊS<span id="rMes">00h:00min</span></div>
      <div class="caixa">ANO<span id="rAno">00h:00min</span></div>
    </div>

    <div id="listaRegistros"></div>

    <br>
    <button onclick="window.print()">Imprimir / Salvar PDF</button>
  </div>

</div>

<script>
setInterval(()=> {
  const d=new Date();
  dataHora.innerText="Hoje: "+d.toLocaleDateString()+" — "+d.toLocaleTimeString();
},1000);

if(localStorage.getItem("nomeFuncionario"))
  nomeFuncionario.value=localStorage.getItem("nomeFuncionario");

function registrar(tipo){
  const dados=JSON.parse(localStorage.getItem("pontos")||"[]");
  dados.push({tipo,iso:new Date().toISOString()});
  localStorage.setItem("pontos",JSON.stringify(dados));
}

function abrirRelatorio(){
  relatorio.style.display=relatorio.style.display==="none"?"block":"none";
  gerarRelatorio();
}

function minToTxt(min){
  return String(Math.floor(min/60)).padStart(2,"0")+"h:"+String(min%60).padStart(2,"0")+"min";
}

function gerarRelatorio(){
  const regs=JSON.parse(localStorage.getItem("pontos")||"[]");
  const hoje=new Date();
  let dia=0,sem=0,mes=0,ano=0;
  let html="",datas=[];

  for(let i=0;i<regs.length;i++){
    const r=regs[i];
    const d=new Date(r.iso);

    html+=`${d.toLocaleDateString()} — ${r.tipo} — ${d.toLocaleTimeString()}<br>`;
    datas.push(d);

    if(d.toDateString()===hoje.toDateString()) dia+=0;
    if(d.getMonth()===hoje.getMonth()) mes+=0;
    if(d.getFullYear()===hoje.getFullYear()) ano+=0;
  }

  tituloNome.innerText="NOME: "+nomeFuncionario.value;
  if(datas.length)
    periodoRelatorio.innerText="PERÍODO: "+datas[0].toLocaleDateString()+" a "+datas[datas.length-1].toLocaleDateString();

  rDia.innerText=minToTxt(dia);
  rSemana.innerText=minToTxt(sem);
  rMes.innerText=minToTxt(mes);
  rAno.innerText=minToTxt(ano);

  listaRegistros.innerHTML=html||"<em>Nenhum registro.</em>";
}
</script>

</body>
</html>
